<div class="servicios-page">
  <!-- Banner -->
  <section class="servicios-banner">
    <div class="container">
      <h1>Nuestros Servicios</h1>
      <p>Soluciones integrales para tus necesidades electromecÃ¡nicas.</p>
      <a routerLink="/brochure/flipbook" class="btn-primary">Ver CatÃ¡logo Completo</a>
    </div>
  </section>

  <!-- Servicios desde la API -->
  <section class="servicios-section">
    <div class="container">
      <div class="filters-container">
        <div class="search-bar">
          <input
            type="text"
            placeholder="Buscar por nombre..."
            (input)="onSearch($event)"
          />
          <i class="fas fa-search"></i>
        </div>
        <div class="filter-controls">
          <select (change)="onCategoryChange($event)">
            <option value="">Todas las categorÃ­as</option>
            <option *ngFor="let categoria of categorias" [value]="categoria">
              {{ categoria }}
            </option>
          </select>
          <select (change)="onStatusChange($event)">
            <option value="">Todos los estados</option>
            <option value="activo">Activo</option>
            <option value="inactivo">Inactivo</option>
          </select>
        </div>
      </div>

      <!-- Mientras carga -->
      <ng-container *ngIf="!isLoading; else loadingTpl">
        <div class="servicios-grid">
          <!-- ðŸ‘‡ ahora iteramos sobre 'filteredServicios' -->
          <div *ngFor="let servicio of filteredServicios" class="servicio-card">
            <div class="servicio-icono" *ngIf="servicio.icono">
              <span class="material-icons">{{ servicio.icono }}</span>
            </div>

            <!-- TÃ­tulo y descripciÃ³n -->
            <h3>{{ servicio.nombre }}</h3>
            <p>{{ servicio.descripcionCorta || servicio.descripcion }}</p>

            <!-- Estado (opcional) -->
            <span
              class="badge"
              [ngClass]="{
                'badge-activo': servicio.estado === 'activo',
                'badge-inactivo': servicio.estado === 'inactivo'
              }"
            >
              {{ servicio.estado | uppercase }}
            </span>

            <!-- Enlace a detalle -->
            <!-- deja la ruta como la tengas definida en el router -->
            <a class="btn-primary" [routerLink]="['/servicios', servicio.id]">
              Ver detalles
            </a>
          </div>
        </div>
        <div
          *ngIf="!isLoading && filteredServicios.length === 0"
          class="empty-state"
        >
          <p>No se encontraron servicios con los filtros seleccionados.</p>
        </div>
      </ng-container>

      <ng-template #loadingTpl>
        <p>Cargando servicios...</p>
      </ng-template>
    </div>
  </section>

  <!-- CTA -->
  <section class="servicios-cta">
    <div class="container">
      <h2>Â¿Listo para empezar?</h2>
      <p>ContÃ¡ctanos para obtener una cotizaciÃ³n personalizada.</p>
      <a routerLink="/contacto" class="btn-secondary">Contactar</a>
    </div>
  </section>
</div>

<!-- CHATBOT -->
<button id="chatbot-toggle" class="chatbot-toggle-hidden">
  <span class="chatbot-icon">ðŸ’¬</span>
  <span class="close-icon">âœ•</span>
</button>

<div id="chatbot-container" class="chatbot-hidden">
  <iframe
    src="https://page.botpenguin.com/690c1346ff158e42155339eb/690c1052cde802431fa13ff0"
    id="chatbot-frame"
    allow="microphone; camera"
  ></iframe>
</div>